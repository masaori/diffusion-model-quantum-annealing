# ã‚´ãƒ¼ãƒ«

- æ‹¡æ•£ãƒ¢ãƒ‡ãƒ«ã®æ•°ç†ã‚’æµã—èª­ã¿ã—ã¦ã€é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° (é‡å­ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°) ã¨é–¢ä¿‚ã‚ã‚Šãã†ã ã¨æ€ã£ãŸ
        - ã®ã§ã€ã“ã‚Œã®æ•°ç†çš„ãªé–¢é€£ã‚’ã–ã£ãã‚Šã¨ç†è§£ã—ãŸã„
        - å¹´å†…ã„ã£ã±ã„ãã‚‰ã„ã§ã€Œã‚ã‹ã£ãŸã€ã¨ã„ã†æ°—åˆ†ã«ãªã‚ŠãŸã„
        - ãªã‚“ã§ã‹ã¨ã„ã†ã¨ã€ä»Šã‹ã‚‰é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®å‹‰å¼·ã«ãƒªã‚½ãƒ¼ã‚¹å‰²ã„ã¦ãŠãã‹ã©ã†ã‹ã‚’è¦‹å®šã‚ãŸã„

## é–¢é€£ã—ãã†ãªé …ç›®

- æ‹¡æ•£ãƒ¢ãƒ‡ãƒ«
        - ç¢ºç‡éç¨‹
- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒ†ã‚£ãƒƒãƒ‰ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°
- é‡å­ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°
- ä»£æ•°çš„ç¢ºç‡ç©ºé–“
        - é‡å­åŠ›å­¦ã«ãŠã„ã¦ã¯ã€è¡Œåˆ—(=ä½œç”¨ç´ )ã®traceãŒæœŸå¾…å€¤
        - ã“ã®è¾ºã‚’æŠ½è±¡åŒ–ã—ã¦ã€ä»£æ•°ã®å…ƒã«ã€Œç¢ºç‡çš„ã€ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨ã¿ãªã—ã¦ã‚´ãƒ‹ãƒ§ã‚´ãƒ‹ãƒ§ã™ã‚‹ã®ãŒç¢ºç‡çš„ä»£æ•°ç©ºé–“ (ã‚¤ãƒ¡ãƒ¼ã‚¸)
        - ã“ã‚Œã‚’ç†è§£ã§ãã‚‹ã¨ã€Œæ‹¡æ•£ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒ«ã‚³ãƒ•éç¨‹ã¯ä»£æ•°çš„ç¢ºç‡ç©ºé–“çš„ã«ã¯ã“ã†ã€ã¿ãŸã„ãªè©±ã‹ã‚‰ã€Œã˜ã‚ƒã‚ã“ã‚“ãªç¨®é¡ã®ä»£æ•°æ§‹é€ ã‹ã‚‰è€ƒãˆãŸã‚‰æ‹¡æ•£ãƒ¢ãƒ‡ãƒ«ã«å½“ãŸã‚‹ã‚‚ã®ã¯ä½•ï¼Ÿã€ã¿ãŸã„ãªè­°è«–ãŒã§ãã¦é¢ç™½ã„ã®ã§ã¯ã€ã¨ã„ã†ä»®èª¬

# èª²é¡Œæ„Ÿ

- å¤§è¦æ¨¡LLMã¯å¤§æ‰‹ã«ç‹¬å ã•ã‚Œã¦ã„ã‚‹
        - GPT 4ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼æ•°ãŒ 170å…†
        - åœ§å€’çš„ãƒ‡ãƒ¼ã‚¿é‡

# æ•™ç§‘æ›¸

- **ç¢ºç‡è«–**: [https://www.amazon.co.jp/gp/product/4254116004/ref=ox_sc_act_image_1?smid=AN1VRQENFRJN5&psc=1](https://www.amazon.co.jp/gp/product/4254116004/ref=ox_sc_act_image_1?smid=AN1VRQENFRJN5&psc=1)
- **ç¢ºç‡å¾®åˆ†æ–¹ç¨‹å¼ã¨ãã®å¿œç”¨:** [https://www.amazon.co.jp/gp/product/4627077815/ref=ox_sc_act_image_2?smid=AN1VRQENFRJN5&psc=1](https://www.amazon.co.jp/gp/product/4627077815/ref=ox_sc_act_image_2?smid=AN1VRQENFRJN5&psc=1)

# è«–æ–‡ã¾ã¨ã‚


## Deep Unsupervised Learning using Nonequilibrium Thermodynamics

éå¹³è¡¡ç†±åŠ›å­¦ã‚’ç”¨ã„ãŸæ•™å¸«ãªã—ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°


[Deep_Unsupervised_Learning_using_Nonequilibrium_Thermodynamics.pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/a95e1e6d-ab5d-426a-b5b6-652ced6dcd2a/673adbff-eaa6-4376-a336-ac3a1b60d50e/Deep_Unsupervised_Learning_using_Nonequilibrium_Thermodynamics.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240118%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240118T043703Z&X-Amz-Expires=3600&X-Amz-Signature=b7f4072570d2ec339eb1e103d5ac017a08fafde6ae0bcb8a10f032deeb173a62&X-Amz-SignedHeaders=host&x-id=GetObject)


[%E6%B7%B1%E5%B1%A4%E7%94%9F%E6%88%90%E3%81%A6%E3%82%99%E4%BD%BF%E3%81%86%E7%A2%BA%E7%8E%87%E8%AB%96_%282%29.pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/a95e1e6d-ab5d-426a-b5b6-652ced6dcd2a/d2520981-ae64-41c7-b76b-2716e4e6dfcd/%E6%B7%B1%E5%B1%A4%E7%94%9F%E6%88%90%E3%81%A6%E3%82%99%E4%BD%BF%E3%81%86%E7%A2%BA%E7%8E%87%E8%AB%96_%282%29.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240118%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240118T043703Z&X-Amz-Expires=3600&X-Amz-Signature=092cdbdb1fdf76d65f7e2db34f2935d331ad4b41a64d9e36da0b16570d558d3c&X-Amz-SignedHeaders=host&x-id=GetObject)


[file]()


# ã‚´ãƒ¼ãƒ«


æ‹¡æ•£ãƒ¢ãƒ‡ãƒ«ã¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒ†ã‚£ãƒƒãƒ‰ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹


# Abstract


æ©Ÿæ¢°å­¦ç¿’ã®ä¸­å¿ƒçš„ãªå•é¡Œã¯ã€å­¦ç¿’ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã€æ¨è«–ã€è©•ä¾¡ãŒä¾ç„¶ã¨ã—ã¦è§£æçš„ã¾ãŸã¯è¨ˆç®—çš„ã«æ‰±ã„ã‚„ã™ã„ã€æŸ”è»Ÿæ€§ã®é«˜ã„ç¢ºç‡åˆ†å¸ƒã®æ—ã‚’ç”¨ã„ã¦ã€è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚ã“ã“ã§ã¯ã€æŸ”è»Ÿæ€§ã¨æ‰±ã„ã‚„ã™ã•ã‚’åŒæ™‚ã«å®Ÿç¾ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’é–‹ç™ºã™ã‚‹ã€‚éå¹³è¡¡çµ±è¨ˆç‰©ç†å­¦ã«è§¦ç™ºã•ã‚ŒãŸæœ¬è³ªçš„ãªè€ƒãˆæ–¹ã¯ã€åå¾©çš„ãªé †æ‹¡æ•£éç¨‹ã‚’é€šã˜ã¦ã€ãƒ‡ãƒ¼ã‚¿åˆ†å¸ƒã®æ§‹é€ ã‚’ç³»çµ±çš„ã‹ã¤ã‚†ã£ãã‚Šã¨ç ´å£Šã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚ãã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’å¾©å…ƒã™ã‚‹é€†æ‹¡æ•£éç¨‹ã‚’å­¦ç¿’ã—ã€ãƒ‡ãƒ¼ã‚¿ã®æŸ”è»Ÿæ€§ã¨æ‰±ã„ã‚„ã™ã•ã®é«˜ã„ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã‚’å¾—ã‚‹ã€‚ã“ã®æ‰‹æ³•ã«ã‚ˆã‚Šã€æ•°åƒã®å±¤ã‚„æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ã‚’æŒã¤æ·±ã„ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã§ç¢ºç‡ã‚’é«˜é€Ÿã«å­¦ç¿’ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã€è©•ä¾¡ã—ã€å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã®ä¸‹ã§æ¡ä»¶ä»˜ãç¢ºç‡ã‚„äº‹å¾Œç¢ºç‡ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã•ã‚‰ã«ã€ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å®Ÿè£…ã‚’å…¬é–‹ã™ã‚‹ã€‚


# 1. Introduction

- ä»¥ä¸‹ãŒãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•
        - æ‰±ã„ã‚„ã™ã• = è§£ææ€§
        - æŸ”è»Ÿæ€§ = å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ§‹é€ ã«å¯¾ã—ã¦å¹…åºƒãé©ç”¨ã§ãã‚‹
                - ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã—ãªã„ã¨ã„ã‘ãªã„

## 1.1. Diffusion probabilistic models

- ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’æç¤ºã™ã‚‹ãã†
        - è¶…æŸ”è»Ÿ
        - ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãŒæ­£ç¢º (?)
        - äº‹å¾Œåˆ†å¸ƒã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã€ä»–ã®åˆ†å¸ƒã¨å®¹æ˜“ã«ä¹—ç®—ã§ãã‚‹ã“ã¨ (?)
        - ãƒ¢ãƒ‡ãƒ«ã®å¯¾æ•°å°¤åº¦ã¨å€‹ã€…ã®çŠ¶æ…‹ã®ç¢ºç‡ã‚’å®‰ä¾¡ã«è©•ä¾¡ã§ãã‚‹ã“ã¨ (?)
- ãƒãƒ«ã‚³ãƒ•é€£é–ã§ã‚ã‚‹åˆ†å¸ƒã‚’åˆ¥ã®åˆ†å¸ƒã«å¾ã€…ã«å¤‰æ›ã™ã‚‹
        - æ‹¡æ•£éç¨‹ã‚’ç”¨ã„ã¦å˜ç´”ãªæ—¢çŸ¥ã®åˆ†å¸ƒ(ã‚¬ã‚¦ã‚¹åˆ†å¸ƒã¨ã‹)ã‚’ç›®æ¨™ã®ãƒ‡ãƒ¼ã‚¿åˆ†å¸ƒã«å¤‰æ›ã™ã‚‹ãƒãƒ«ã‚³ãƒ•é€£é–ã‚’æ§‹ç¯‰ã™ã‚‹
        - å„ã‚¹ãƒ†ãƒƒãƒ—ã‚‚é€£é–ã®å…¨ä½“ã‚‚è§£æçš„ã«è©•ä¾¡ã§ãã‚‹
- estimating small perturbations (?)
- explicitly describing the full distribution with a single, non-analytically-normalizable, potential function. (?)
        - åˆ†é…é–¢æ•°ãŒã€æ•°å¼ã§ã‹ã‘ãªã„ãã‚‰ã„ã®æ„å‘³
- We demonstrate the utility of these diffusion probabilistic models by training high log likelihood models for a twodimensional swiss roll, binary sequence, handwritten digit
(MNIST), and several natural image (CIFAR-10, bark, and
dead leaves) datasets.
        - Swiss roll â‡’ æ¸¦å·»ãçŠ¶ã®ç·šå½¢åˆ†é›¢ã§ããªã„ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã“ã¨
- posterior probability äº‹å¾Œç¢ºç‡
- prior probability äº‹å‰ç¢ºç‡
- marginal probability distribution å‘¨è¾ºç¢ºç‡å¯†åº¦

## ç”¨èª


### å¯æ¸¬ç©ºé–“

- çµ„ã¿$(\Omega, F)$
        - $\Omega$ : set
        - $F$ : å®Œå…¨åŠ æ³•æ—
                - å®Œå…¨åŠ æ³•æ€§ã‚’æº€ãŸã™ã€$\Omega$ã®å†ªé›†åˆã®éƒ¨åˆ†é›†åˆ

### å¯æ¸¬å†™åƒ

- $(\Omega, F), (\Psi, G): å¯æ¸¬ç©ºé–“$
        - $f: (\Omega, F) \to (\Psi, G)$ ã§ä»¥ä¸‹ã‚’æº€ãŸã™
        - $\forall A \in G \space f^{-1}(A) \in F$
        - ** $f: (\Omega, F) \to (\Psi, G)$ ã“ã†æ›¸ã„ãŸã¨ãã®å®Ÿæ…‹ã¯ $f: F \to G$

### æ¸¬åº¦ç©ºé–“

- çµ„ã¿$(\Omega, F, \mu)$
        - $\mu:F\to \mathbb{R}_{\geq0}$
                - å¯ç®—åŠ æ³•æ€§ã‚’æº€ãŸã™
                        - $\displaystyle \forall i,j \in \mathbb{N}, A_i, A_j \in F \space A_i \cup A_j = \empty \implies \mu\left(\bigcup_{i} A_{i} \right) = \sum_{i} \mu\left(A_{i} \right)$

### å®Ÿæ•° (æ¸¬åº¦ç©ºé–“ã®å…·ä½“ä¾‹)

- $(\mathbb{R},B(\mathbb{R}),\mu)$
        - $B(\mathbb{R}):ãƒœãƒ¬ãƒ«é›†åˆæ—$
                - $\mathbb{R}ä¸Šã®è·é›¢ã‹ã‚‰å®šã¾ã‚‹ä½ç›¸ã‚’å«ã‚€æœ€å°ã®å®Œå…¨åŠ æ³•æ—$
        - $\mu: ãƒ«ãƒ™ãƒ¼ã‚°æ¸¬åº¦$
                - è·é›¢ã‹ã‚‰è‡ªç„¶ã«å®šã¾ã‚‹ã€Œé•·ã•ã€
                - $\mu([0,1]) = 1$
                - $\mu([a, b]) = b - a$

### ç¢ºç‡ç©ºé–“

- æ¸¬åº¦ç©ºé–“ $(\Omega, F, P)$ã§ä»¥ä¸‹ã‚’æº€ãŸã™ã‚‚ã®
        - $P\left(\Omega\right) = 1$
- $\Omega$ ã‚’**æ¨™æœ¬ç©ºé–“**ã¨ã„ã†
        - $\Omega$ã®å…ƒã‚’**æ¨™æœ¬**ã¨ã„ã†
- $F$ ã‚’**äº‹è±¡ã®å…¨ä½“**ã¨ã„ã†
        - $F$ã®å…ƒã‚’**äº‹è±¡**ã¨ã„ã†
- $P$ ã‚’**ç¢ºç‡æ¸¬åº¦**ã¨ã„ã†

### ç¢ºç‡å¤‰æ•° (random variety)

- $X: (\Omega, F)\to (\mathbb{R},\mathfrak{B}(\mathbb{R}))$
        - $X$ã¯ã€å¯æ¸¬ãªã€äº‹è±¡ã®å…¨ä½“ã‹ã‚‰ãƒœãƒ¬ãƒ«é›†åˆæ—ã¸ã®å†™åƒã§ã‚ã‚‹

### $X$ã«ç”±æ¥ã™ã‚‹ç¢ºç‡æ¸¬åº¦

- $P_{X}: \mathfrak{B}(\mathbb{R})\to \mathbb{R},\ A \mapsto P(X^{-1}(A))$
        - $(\mathbb{R},\mathfrak{B}(\mathbb{R}),P_X) ã¯ç¢ºç‡ç©ºé–“ã«ãªã£ã¦ã„ã‚‹$

### ç¢ºç‡å¯†åº¦é–¢æ•° (= Px1ã®æ™‚ã«ç¢ºç‡åˆ†å¸ƒã£ã¦é©å½“ã«æ›¸ã‹ã‚Œã¦ãŸã‚‰ã“ã‚Œ)


$$
p_{X_{abs}}:\mathbb{R} \to \mathbb{R}_{\geq0}
$$

- æ°—æ¸©ãŒ20åº¦ã‹ã‚‰30åº¦ã«ãªã‚‹ç¢ºç‡ã‚’æ±‚ã‚ãŸã„æ™‚ã«ã€
        - ã€Œæ°—æ¸©xåº¦ã€ã‚’å®Ÿæ•°xã«ãƒãƒƒãƒ—ã™ã‚‹ â† ç¢ºç‡å¤‰æ•°ã¨ã„ã†
        - å®Ÿæ•°ç›´ç·šä¸Šã§20-30ã®åŒºé–“ã§ç©åˆ†ã™ã‚‹

### ç¢ºç‡è³ªé‡é–¢æ•° (= Px3ã®æ™‚ã«ç¢ºç‡åˆ†å¸ƒã£ã¦é©å½“ã«æ›¸ã‹ã‚Œã¦ãŸã‚‰ã“ã‚Œ)


$$
p_{x_{3}}:\mathbb{R} \to [0,1] \\ x \mapsto P_{x_{3}}(\{x\})
$$


## å¤šå¤‰æ•°ã®å ´åˆ


### då¤‰æ•°ç¢ºç‡å¤‰æ•° (random variety)


$X_{1}, \dots ,X_{d}:1å¤‰æ•°ç¢ºç‡å¤‰æ•°$


$$
X^{d}: (\Omega, F)\to (\mathbb{R}^d,\mathfrak{B}(\mathbb{R}^d)), \  \omega \mapsto (X_{1}(\omega), \dots,X_{d}(\omega))
$$


### ç¢ºç‡å¯†åº¦é–¢æ•°

Radon-Nikodymã®å®šç†ã®å¤šå¤‰æ•°ç‰ˆã‹ã‚‰å®šã¾ã‚‹
$$p_{X^{d}_{abs}}: \mathbb{R}^{d} \rightarrow \mathbb{R}_{\geq 0}$$


### ç´¯ç©åˆ†å¸ƒé–¢æ•°

- ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’$-\infty$ã‹ã‚‰$x$ã¾ã§ç©åˆ†ã—ãŸã‚‚ã®

### æ¡ä»¶ä»˜ãç¢ºç‡


$(\Omega, F, P): ç¢ºç‡ç©ºé–“, A, B \in F$ã«ã¤ã„ã¦ã€


$P(\cdot\mid\cdot):F\times F\to[0,1]$


$$
P(A|B):=\frac{\mathrm{P}(A \cap B)}{\mathrm{P}(B)}
$$


### æ¡ä»¶ã¤ãç¢ºç‡å¯†åº¦é–¢æ•°

$Y_{1}, Y_{2}$: 1å¤‰æ•°ç¢ºç‡å¤‰æ•°ã«ã‚ˆã£ã¦å®šã¾ã‚‹$Y^{2}$: 2å¤‰æ•°ç¢ºç‡å¤‰æ•°


$p_{(Y_{1}, Y_{2})_{abs}}(\cdot\mid\cdot):\mathbb{R}\times\mathbb{R} \to \mathbb{R}_{\geq 0}$


$$
p_{(Y_{1}, Y_{2})_{abs}}(y_{1} \mid y_{2}) := \frac{p_{Y^{2}_{abs}}(y_{1}, y_{2})}{p_{Y_{2\ abs}}(y_{2})}
$$


---


[%E6%B7%B1%E5%B1%A4%E7%94%9F%E6%88%90%E3%81%A6%E3%82%99%E4%BD%BF%E3%81%86%E7%A2%BA%E7%8E%87%E8%AB%96.pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/a95e1e6d-ab5d-426a-b5b6-652ced6dcd2a/3241d1d3-e482-46b1-949a-1873d07c9c6e/%E6%B7%B1%E5%B1%A4%E7%94%9F%E6%88%90%E3%81%A6%E3%82%99%E4%BD%BF%E3%81%86%E7%A2%BA%E7%8E%87%E8%AB%96.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240118%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240118T043703Z&X-Amz-Expires=3600&X-Amz-Signature=9fb2ee88ea9fee61c1b622867c2203fa55711d24b7155c0a4abe1eb88b743dcc&X-Amz-SignedHeaders=host&x-id=GetObject)


## å®šç†


### Lebesgueã®åˆ†è§£å®šç†

$\mu: B(\mathbb{R}) \rightarrow \mathbb{R}$ ã‚’ Lebegue Measure ã¨ã™ã‚‹.
$$
P_X=P_{X_{abs}}+P_{x_{sing}}+P_{x_{dis}} \ s.t.
$$
- $P_{X_{abs}}$ ã¯ $\mu$ ã«ã¤ã„ã¦ã€ absolutely conti.
    - ã™ãªã‚ã¡ã€ $\mu(A)=0$ ãªã‚‰ã° $P_{X_{abs}}(A)=0(\forall A \in B(\mathbb{R}))$
- $P_{x_{sing}}$ ã¯ $\mu$ ã«ã¤ã„ã¦ã€conti. ã‹ã¤ã€ singular.
    - ã™ãªã‚ã¡ã€ $P_{x_{sing}}(a)=0(\forall a \in \mathbb{R})$ ã‹ã¤ã€ $\exists A \in A(\mathbb{R})$ s.t. $\mu(A)=0$ and $P_{x_{sing}}\left(A^c\right)=0$
- $P_{x_{dis}}$ ã¯ $\mu$ ã«ã¤ã„ã¦ã€ discrete.
    - ã™ãªã‚ã¡ã€ $\exists\left\{a_n\right\}_{n=1}^{\infty} \subset \mathbb{R}$ s.t. $P_{x_{dis}}=\sum_{i=1}^{\infty} a_i \chi_{P_i}(A)$ $\left(\right.$ ãŸã ã—ã€ $\chi_{P_i}: B(\mathbb{R}) \rightarrow \mathbb{R}, \chi_{P_i}(A):=\left\{\begin{array}{l}0\left(p_i \notin A\right) \\ 1\left(p_i \in A\right)\end{array}\right)$

ã¨ä¸€æ„ã«åˆ†è§£ã§ãã‚‹.

- æ‹¡æ•£ãƒ¢ãƒ‡ãƒ«ã®æ•°ç†ã‚’èª­ã‚€ä¸Šã§ã¯Px1ã ã‘è€ƒãˆã‚‹ã§OK

### Radon-Nikodymã®å®šç†
$X$: ç¢ºç‡å¤‰æ•°

Lebegue ã® $P_{X_{abs}}$ ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã‚’æº€ãŸã™ Integrable ãªé–¢æ•° $p_{X_{abs}}: \mathbb{R} \rightarrow \mathbb{R}_{\geq 0}$ ãŒå­˜åœ¨ã™ã‚‹ã€‚
$$
\int_{-\infty}^x p_{X_{abs}}\left(x^{\prime}\right) d x^{\prime}=P_{X_{abs}}(X \leq x)
$$

ã“ã® $P_{X_{abs}}$ ã‚’ã€ç¢ºç‡å¯†åº¦é–¢æ•° (Probabilty Density Function) ã¨å‘¼ã¶ã€‚

#### å¤šå¤‰æ•°ã®å ´åˆ
$X_{1},\dots,X_{d}$: 1å¤‰æ•°ç¢ºç‡å¤‰æ•°ã«ã‚ˆã£ã¦å®šã¾ã‚‹ã€$X^{d}$: då¤‰æ•°ç¢ºç‡å¤‰æ•°ã«ã¤ã„ã¦ã€


Lebegue ã® $P_{X_{abs}}$ ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã‚’æº€ãŸã™ Integrable ãªé–¢æ•° $p_{X^{d}_{abs}}: \mathbb{R}^{d} \rightarrow \mathbb{R}_{\geq 0}$ ãŒå­˜åœ¨ã™ã‚‹ã€‚
$$
\int_{-\infty}^{x_{1}} \cdots \int_{-\infty}^{x_{d}} p_{X_{abs}}\left(x^{\prime}\right) d x^{\prime}=P_{X_{abs}}(X_{1} \leq x_{1}Â \land \dots \land X_{d} \leq x_{d})
$$

ã“ã® $P_{X_{abs}}$ ã‚’ã€ç¢ºç‡å¯†åº¦é–¢æ•° (Probabilty Density Function) ã¨å‘¼ã¶ã€‚

> [ãƒ•ãƒ“ãƒ‹ã®å®šç†](https://ja.wikipedia.org/wiki/%E3%83%95%E3%83%93%E3%83%8B%E3%81%AE%E5%AE%9A%E7%90%86) ã«ã‚ˆã‚Šã€$\mathbb{R}^{d}$ã«ã¤ã„ã¦ã®ç©åˆ†ã¯då›ã®$\mathbb{R}$ã«ã¤ã„ã¦ã®ç©åˆ†ã¨ç­‰ã—ããªã‚‹ã€‚

### KL-ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹


$$
D_{K L}(P \| Q):=\sum_{i=1}^{\infty} p_{X_{dis}}\left(x_i\right) \log \frac{p_{X_{dis}}\left(x_i\right)}{q_{X_{dis}}\left(x_i\right)}+\int_{\mathbb{R}} p_{X_{abs}}(x) \log \frac{p_{X_{abs}}(x)}{q_{X_{abs}}(x)} d x
$$


$p, q$ã‚’ç¢ºç‡è³ªé‡é–¢æ•°ã¨ã™ã‚‹ã¨ãã€


$$
D_{K L}(p \| q):=\sum_{i=1}^{\infty} p\left(x_i\right) \log \frac{p\left(x_i\right)}{q\left(x_i\right)}
$$


### æ¡ä»¶ä»˜ãã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼

ç¢ºç‡ç©ºé–“$(\mathbb{R}, \mathfrak{B}(\mathbb{R}),F)$ã«ã¤ã„ã¦ã€
ç¢ºç‡å¯†åº¦é–¢æ•°$p_{X_{abs}}$ã€ç¢ºç‡å¤‰æ•°$X, Y$ã«ã¤ã„ã¦ã€


$$
H(Y|X) := -\int_{x \in \mathcal{X}, y \in \mathcal{Y}} dxdy \ p(x, y) \log \frac{p(x, y)}{p(x)}
$$


(1/18)

- â†‘ç¶šã
    - [https://en.wikipedia.org/wiki/Conditional_entropy](https://en.wikipedia.org/wiki/Conditional_entropy)
    - æ¡ä»¶ä»˜ãç¢ºç‡å¯†åº¦é–¢æ•°ãŒå®šã¾ã£ãŸã®ã§ã€ã“ã‚Œã‚’ç”¨ã„ã¦å®šã‚ã‚‹
- é–¢æ•°è§£æã«è¸ã¿è¾¼ã‚€ã¨ã—ãŸã‚‰
    - [å½¢çŠ¶æœ€é©åŒ–å•é¡Œ](https://www.morikita.co.jp/books/mid/061461)
- vscodeã§Texã§æ›¸ãæ–¹æ³•ã«ç§»æ¤ã™ã‚‹
- â†‘Î²ãŒå°ã•ã„æ™‚ã«forwardã¨reverseãŒç­‰ã—ããªã‚‹ã€ã¯ã‚ˆãã‚ã‹ã‚‰ãªã„ã®ã§ä¿ç•™
- ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…(on github)ã‚‚è¦‹ã¦ã¿ã‚‹ [https://github.com/Sohl-Dickstein/Diffusion-Probabilistic-Models/blob/master/model.py](https://github.com/Sohl-Dickstein/Diffusion-Probabilistic-Models/blob/master/model.py)
- ä¸€æ—¦èª­ã¿çµ‚ãˆã¦ã¿ã¦ã‹ã‚‰ã€å‚è€ƒæ–‡çŒ®è¦‹ã¦ã¿ã‚‹ï¼Ÿ
        - ã‚¬ã‚¦ã‚¹éç¨‹äº‘ã€…

---


### parametricãªå•é¡Œ


$$
{ }^{\exists} p: \mathbb{R} \times \mathbb{R} \rightarrow \mathbb{R}, \quad(x, \theta) \mapsto p_\theta(x), å…·ä½“çš„ã«è¨ˆç®—å¯èƒ½, \\ { }^{\exists} \theta_0 \in \mathbb{R} \text { s.t. } p_{X_{abs}}=p_{\theta_0}
$$


$p_{X_{abs}}$ã‚’æ±‚ã‚ã‚‹å•é¡Œã‚’parametricãªå•é¡Œã¨ã„ã†


($p_{x_{3}}$ã«ã¤ã„ã¦ã‚‚ã ã„ãŸã„åŒã˜)


### likelihood function


$\left(x_i\right)_{i=1}^n$: nå›ã®trial ãŒä¸ãˆã‚‰ã‚ŒãŸæ™‚ã€


$$
L: \mathbb{R} \rightarrow \mathbb{R}, \quad \theta \mapsto \prod_{i=1}^n p\left(x_i, \theta\right)
$$


### log-likelihood function


$\left(x_i\right)_{i=1}^n$: nå›ã®trial ãŒä¸ãˆã‚‰ã‚ŒãŸæ™‚ã€


$$
L_{\log}: \mathbb{R} \rightarrow \mathbb{R}, \quad \theta \mapsto \sum_{i=1}^n  \log(p\left(x_i, \theta\right))
$$


### likelihood estimation


$L, L_{\log}$ã®æœ€å¤§å€¤ã€ã‚‚ã—ãã¯æ¥µå€¤ã‚’æ±‚ã‚ã‚‹


ã‚³ã‚¤ãƒ³æŠ•ã’ã®å ´åˆã€å°¤åº¦é–¢æ•°ã¯ä¸Šã«å‡¸ãªã®ã§ã€æ¥µå€¤ãŒæ±‚ã¾ã‚Œã°è‰¯ã„


---


## Sanovã®å®šç†[https://genkuroki.github.io/documents/20160616KullbackLeibler.pdf](https://genkuroki.github.io/documents/20160616KullbackLeibler.pdf)



å‚è€ƒ) [https://genkuroki.github.io/documents/mathtodon/2017-04-27 Kullback-Leibleræƒ…å ±é‡ã¨ã¯ä½•ã‹ï¼Ÿ.pdf](https://genkuroki.github.io/documents/mathtodon/2017-04-27%20Kullback-Leibler%E6%83%85%E5%A0%B1%E9%87%8F%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B%EF%BC%9F.pdf)


### çµŒé¨“åˆ†å¸ƒ


ré¢ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹ã¨ã„ã†ã“ã¨ã‚’è€ƒãˆã‚‹


$$
\mathcal{P}=\left\{p=\left(p_1, \ldots, p_r\right) \in \mathbb{R}^r \mid p_1, \ldots, p_r \geqq 0, p_1+\cdots+p_r=1\right\}
$$


ã¨å®šã‚ã‚‹ã¨ã€$\mathcal{P}$ã¯ã€æœ‰é™é›†åˆ $\{1, ..., r\}$ä¸Šã®ç¢ºç‡è³ªé‡é–¢æ•°ã®é›†åˆã¨åŒä¸€è¦–ã§ãã‚‹ã€‚


$q = (q_{1},...,q_{r}) \in \mathcal{P}$ ã‚’å›ºå®šã™ã‚‹ã€‚ã“ã‚Œã¯ã‚ã‚‹ã‚µã‚¤ã‚³ãƒ­qã‚’å›ºå®šã™ã‚‹ã¨ã„ã†ã“ã¨ã€‚


 $\Omega_{q} := \{ã‚µã‚¤ã‚³ãƒ­qã‚’æŠ•ã’ãŸæ™‚ã«iãŒå‡ºã‚‹ \mid i=1, ..., r\}$


ç¢ºç‡ç©ºé–“: $((\Omega_{q})^{n}, F_{q}^{n} = 2^{(\Omega_{q})^{n}}, P^{n})$


$X \in F_{q}^{n}$ã¯ã€


$$
X = \{(\ell_{i}^{1})_{i=1,...,n} ,...,  (\ell_{i}^{j})_{i=1,...,n}\} \\ \left(j=0,...,r^{n}, 1 \leq \ell_{i}^{j} \leq r, ãŸã ã—j=0ã®æ™‚ã¯X=\empty \right)
$$


    ã¨æ›¸ã‘ã‚‹


$$
r^{n}: å…¨ã¦ã®æ ¹æºäº‹è±¡ã®æ•° \\
(\ell_{i}^{j})_{i=1,...,n}: ã‚ã‚‹äº‹è±¡Xã®ä¸­ã§ã€iå›ç›®ã«\ell_{i}^{j}ãŒå‡ºã‚‹ã‚ˆã†ãªjç•ªç›®ã®æ ¹æºäº‹è±¡
$$


$P^{n}: F_{q}^{n}\to\mathbb{R} $ ã‚’ã€


$$
P^{n}(\{(\ell_{i}^{1})_{i=1,...,n} ,...,  (\ell_{i}^{j})_{i=1,...,n}\}):= (q_{\ell^{1}_{1}} q_{\ell^{1}_{2}} \cdots q_{\ell^{1}_{n}}) + \cdots + (q_{\ell^{j}_{1}} q_{\ell^{j}_{2}} \cdots q_{\ell^{j}_{n}})
$$


ã¨å®šã‚ã‚‹ã€‚


$(k_{i})_{i=1,...,n}$ã«ã¤ã„ã¦ã€


$$
X_{(k_{w})_{w=1,...,r}} := \{(\ell_{i}^{j})_{i=1,...,n}|^\forall w \left( (\ell_{i}^{j} = wã¨ãªã‚‹å€‹æ•°) = k_{w} \right) \}
$$


ãªã‚‹äº‹è±¡ã®èµ·ã“ã‚‹ç¢ºç‡ã¯ã€$\#X_{(k_{w})_{w=1,...,r}} = \frac{n !}{k_{1} ! \cdots k_{r} !}$ãªã®ã§ã€


$$
P^n(X_{(k_{w})_{w=1,...,r}}) = \frac{n !}{k_{1} ! \cdots k_{r} !} q_1^{k_1} \cdots q_r^{k_r}
$$


ã¨ãªã‚‹ã€‚


ã“ã“ã§ã€é›†åˆ$\mathcal{P}_{n}$ã‚’ã€


$$
\mathcal{P}_n=\left\{\left(\frac{k_1}{n}, \ldots, \frac{k_r}{n}\right) \mid k_i=0,1, \ldots, n, k_1+\cdots+k_r=n\right\}
$$


ã¨å®šã‚ã‚‹ã¨ã€


$$
\mathcal{P}_n \subset \mathcal{P}
$$


ã§ã‚ã‚Šã€$\#\mathcal{P}_{n} \leq (n+1)^r$ ã§ã‚ã‚‹ã€‚


ã“ã®ã‚ˆã†ãª$\mathcal{P}_n$ã®å…ƒã‚’ã€


$$
X_{(k_{i})_{i=1,...,n}}ã«å¯¾ã—ã¦ã®çµŒé¨“åˆ†å¸ƒ
$$


ã¨ã„ã†ã€‚


### Sanovã®å®šç†


$q = (q_{1},...,q_{r}) \in \mathcal{P}$ã¨ã€ä¸Šè¨˜ã®è¨˜å·ã®å…ƒã€ç¢ºç‡ç©ºé–“$(\mathcal{P}_{n}, 2^{\mathcal{P}_{n}}, P_{\mathcal{P}_{n}, q})$ã‚’è€ƒãˆã‚‹


ç¢ºç‡æ¸¬åº¦ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã‚ã‚‹


$$
P_{\mathcal{P}_{n}, q}^{\prime}:\mathcal{P}_{n} ã®ä¸€ç‚¹é›†åˆã®é›†åˆ\to\mathbb{R} \\ \{\left(\frac{k_1}{n}, \ldots, \frac{k_r}{n}\right)\} \mapsto \frac{n !}{k_{1} ! \cdots k_{r} !} q_1^{k_1} \cdots q_r^{k_r}
$$


$$
P_{\mathcal{P}_{n}, q}:2^{\mathcal{P}_{n}}\to\mathbb{R} \\ \{x_{1},...,x_{k}\} \mapsto \sum_{i}^{k}P_{\mathcal{P}_{n}, q}^{\prime}(\{x_{i}\})
$$


(1) $A \subset \mathcal{P}$ ãŒopenã§ã‚ã‚‹æ™‚


$$
\liminf _{n \rightarrow \infty} \frac{1}{n} \log P_{\mathcal{P}_n, q}\left( A\cap\mathcal{P}_n\right) \geqq-\inf _{p \in A} D_{KL}(p \| q)
$$


Aã‚’å¤§ããã™ã‚‹ã¨ã€


((å·¦è¾º)ã®$\frac{1}{n} \log P_{\mathcal{P}_n, q}\left( A\cap\mathcal{P}_n\right)$)ã¯ã€å¤§ãããªã‚‹ã‹å¤‰ã‚ã‚‰ãªã„


(å³è¾º)ã¯ã€å¤§ãããªã‚‹ã‹å¤‰ã‚ã‚‰ãªã„


(2) $A \subset \mathcal{P}$ã«ã¤ã„ã¦ã€


$$
\limsup _{n \rightarrow \infty} \frac{1}{n} \log P_{\mathcal{P}_n, q}\left(A\cap\mathcal{P}_n\right) \leqq-\inf _{p \in A} D_{KL}(p \| q)
$$


(3) $A \subset \mathcal{P}$ãŒã€å†…éƒ¨ãŒé–‰åŒ…ã«å«ã¾ã‚Œã‚‹ãªã‚‰ã°ã€


$$
\lim_{n \rightarrow \infty} \frac{1}{n} \log P_{\mathcal{P}_n, q}\left(A\cap\mathcal{P}_n\right) =-\inf _{p \in A} D_{KL}(p \| q)
$$

- ä»®èª¬Aã‚’ã¨ã‚‹
    - Aã¯çµã‚‰ã‚Œã¦ã‚‹ã»ã†ãŒã€å®Ÿç”¨ä¸Šã€Œã„ã„ä»®èª¬ã€ã¨è¨€ãˆã‚‹
            - ãŒã€Sanovã®å®šç†ã§ã¯ãã“ã¯èˆˆå‘³ãªã„
    - $P_{\mathcal{P}_n, q}\left(A\cap\mathcal{P}_n\right) $ : nå›è©¦è¡Œæ™‚ã®çµŒé¨“åˆ†å¸ƒãŒAã«å…¥ã‚‹ç¢ºç‡

    â†’ nå›æŒ¯ã£ã¦å¾—ã‚‰ã‚ŒãŸçµŒé¨“åˆ†å¸ƒã‚’ä½•å€‹ã‚‚å–å¾—ã—ã¦ã€$P_{\mathcal{P}_n, q}\left(A\cap\mathcal{P}_n\right) $ã‚’å®šã‚ã‚‹

    - å·¦è¾ºã®nã‚’ã©ã‚“ã©ã‚“å¤§ããã—ã¦ã€åæŸã™ã‚‹å€¤ã«ã‚ˆã£ã¦ã€Aã®ã€Œæ­£è§£ã£ã½ã•ã€ãŒã‚ã‹ã‚‹
            - ã‚‚ã—0ã«åæŸã—ã¦ã„ã‚‹ã®ãªã‚‰ã°ã€Aã«çœŸã®åˆ†å¸ƒqãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹

## 1.2. Relationship to other work


é£›ã°ã™


# 2. Algorithm

- é †æ‹¡æ•£éç¨‹ã¨é€†æ‹¡æ•£éç¨‹ã®å®šç¾©
- é€†æ‹¡æ•£éç¨‹ã®å­¦ç¿’æ–¹æ³•
- é€†æ‹¡æ•£éç¨‹ã®entropy bounds(ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ä¸‹ç•Œï¼Ÿ)ã‚’å°å‡ºã™ã‚‹

### ãƒãƒ«ã‚³ãƒ•æ‹¡æ•£ã‚«ãƒ¼ãƒãƒ« ([Markov kernel](https://en.wikipedia.org/wiki/Markov_kernel))


$T_{\pi}: \mathbb{R}^{n}\times\mathbb{R}^{n}\times\mathbb{R}\to\mathbb{R},\ \left(\mathbf{y} , \mathbf{y}^{\prime} , \beta\right) \mapsto T_\pi\left(\mathbf{y} \mid \mathbf{y}^{\prime} ; \beta\right)$ã€€($\beta$ã¯ã€æ‹¡æ•£ç‡)


$\pi: \mathbb{R}^{n}\to\mathbb{R}$ ã¯ã€ä»¥ä¸‹ã®ç¬¬äºŒç¨®ãƒ•ãƒ¬ãƒ‰ãƒ›ãƒ«ãƒ ç©åˆ†æ–¹ç¨‹å¼ã®è§£


$$
\begin{aligned}\pi(\mathbf{y}) & =\int d \mathbf{y}^{\prime} T_\pi\left(\mathbf{y} \mid \mathbf{y}^{\prime} ; \beta\right) \pi\left(\mathbf{y}^{\prime}\right)\end{aligned}
$$

- [https://ja.wikipedia.org/wiki/ãƒ•ãƒ¬ãƒ‰ãƒ›ãƒ«ãƒ ç©åˆ†æ–¹ç¨‹å¼](https://ja.wikipedia.org/wiki/%E3%83%95%E3%83%AC%E3%83%89%E3%83%9B%E3%83%AB%E3%83%A0%E7%A9%8D%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F)

$0 \leq i \leq Tã«å¯¾ã—ã¦ \ X^{(i)} = \mathbb{R}^{n}$


$1 \leq i \leq Tã«å¯¾ã—ã¦ \ \beta_{i} \in \mathbb{R}$ : t-1ã¨tã®é–“ã®æ‹¡æ•£ç‡


$\mathbf{x}^{(i\dots j)} := (\mathbf{x}^{(i)},\dots , \mathbf{x}^{(j)})\in\prod_{t=i}^{j} X^{(t)}$ ã¨æ›¸ã


## 2.1. Forward Trajectory


$Q^{(0)}: \mathfrak{B}(X^{(0)})\to\mathbb{R}$: ç¢ºç‡æ¸¬åº¦


$q^{(0)}_{X_{abs}}:X^{(0)}\to\mathbb{R},\ Q^{(0)}$ã‹ã‚‰å®šã¾ã‚‹ç¢ºç‡å¯†åº¦é–¢æ•°


$q^{(0\dots i)}_{X_{abs}}:\prod_{t=0}^{i} X^{(t)}\to\mathbb{R}$ã‚’


$$
q^{(0\dots i)}_{X_{abs}}(\mathbf{x}^{(0\dots i)}) := q^{(0)}_{X_{abs}}\left(\mathbf{x}^{(0)}\right) \prod_{t=1}^i T_{\pi}\left(\mathbf{x}^{(t)} \mid \mathbf{x}^{(t-1)};\beta_{t}\right)
$$


$q^{(T)}_{X_{abs}}:X^{(T)}\to\mathbb{R},\ q^{(T)}_{X_{abs}}(\mathbf{x}^{(T)}) := \int d \mathbf{y}^{(0 \dots T-1)} q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0\dots T-1)},\mathbf{x}^{(T)}\right)$


## 2.2. Reverse Trajectory


$p^{(T)}_{X_{abs}}:X^{(T)}\to\mathbb{R},\ p^{(T)}_{X_{abs}}(\mathbf{x}^{(T)}) := \pi(\mathbf{x}^{(T)})$


$p^{(i\dots T)}_{X_{abs}}:\prod_{t=i}^{T} X^{(t)}\to\mathbb{R}$


$$
p^{(i\dots T)}_{X_{abs}}(\mathbf{x}^{(i\dots T)}) := p^{(T)}_{X_{abs}}\left(\mathbf{x}^{(T)}\right) \prod_{t=1}^T T_{\pi}\left(\mathbf{x}^{(t-1)} \mid \mathbf{x}^{(t)};\beta_{t}\right)
$$


## 2.3. Model Probability


> ã“ã‚Œã¯ã€çµ±è¨ˆç‰©ç†å­¦ã«ãŠã‘ã‚‹æº–é™çš„éç¨‹ã®å ´åˆã«ç›¸å½“ã™ã‚‹

- [éå¹³è¡¡ç§‘å­¦](https://sosuke110.com/noneq-phys.pdf)
- [æ©Ÿæ¢°å­¦ç¿’ã®ãŸã‚ã®ç¢ºç‡éç¨‹](https://www.amazon.co.jp/%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E7%A2%BA%E7%8E%87%E9%81%8E%E7%A8%8B%E5%85%A5%E9%96%80-%E2%80%95%E7%A2%BA%E7%8E%87%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%8B%E3%82%89%E3%83%99%E3%82%A4%E3%82%BA%E3%83%A2%E3%83%87%E3%83%AB-%E6%8B%A1%E6%95%A3%E3%83%A2%E3%83%87%E3%83%AB%E3%81%BE%E3%81%A7%E2%80%95-%E5%86%85%E5%B1%B1%E7%A5%90%E4%BB%8B-ebook/dp/B0CK176SH5/ref=tmm_kin_swatch_0?_encoding=UTF8&qid=&sr=)

$p^{(0)}_{X_{abs}}:X^{(0)}\to\mathbb{R},\ p^{(0)}_{X_{abs}}(\mathbf{x}^{(0)}) := \int d \mathbf{y}^{(1 \dots T)} p^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)$


$= \int d \mathbf{y}^{(1 \dots T)} p^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)\frac{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}$


$= \int d \mathbf{y}^{(1 \dots T)}q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \frac{p^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}$


$= \int d \mathbf{y}^{(1 \dots T)}q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \cdot \frac{p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{x}^{(0)}\right)} \cdot \frac{T_{\pi}\left(\mathbf{x}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{x}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)$


ã“ã®ç©åˆ†ã¯ã€è¤‡æ•°ã®ã‚µãƒ³ãƒ—ãƒ« $q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right) $ ã®å¹³å‡ã‚’å–ã‚‹ã“ã¨ã§ã€ç´ æ—©ãè©•ä¾¡ã§ãã‚‹ã€‚


$\beta_{t}$ãŒç„¡é™å°ã®ã¨ãã€$\frac{T_{\pi}\left(\mathbf{x}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{x}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)=1$ã¨ãªã‚‹ã€‚

- ã¤ã¾ã‚Šã€$1 \leq t \leq T$ã«ã¤ã„ã¦ã€$T_{\pi}\left(\mathbf{x}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right) = T_{\pi}\left(\mathbf{x}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)$ â† ?
- ã“ã®ã¨ãã€ä¸Šè¨˜ã®ç©åˆ†ã‚’è©•ä¾¡ã™ã‚‹ã®ã«è¦æ±‚ã•ã‚Œã‚‹ã®ã¯ã€å˜ä¸€ã®ã‚µãƒ³ãƒ—ãƒ«$q^{(0\dots T)}_{X_{abs}}\left(\mathbf{x}^{(0)},\mathbf{y}^{(1 \dots T)}\right) $ã®ã¿ã§ã‚ã‚‹

> ğŸ’¡ $q^{(0)}_{x_{i}}:$ ä¸ãˆã‚‰ã‚ŒãŸçœŸã®ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒ  
> $ p^{(0)}_{x_{i}}: $ Reverse trajectoryã‚’ç”¨ã„ã¦è¨ˆç®—ã•ã‚ŒãŸã€$q^{(0)}_{x_{i}}$ã®è¿‘ä¼¼


ä»¥ä¸‹ã§ã€$p^{(0)}_{x_{i}}, q^{(0)}_{x_{i}}$ã®Cross Entropyã‚’æœ€å°åŒ–ã™ã‚‹


## 2.4. Training


$H(p^{(0)}_{X_{abs}}, q^{(0)}_{X_{abs}}):$ Cross Entropy


$H(p^{(0)}_{X_{abs}}, q^{(0)}_{X_{abs}})
=-\int_{X^{(0)}} d \mathbf{y}^{(0)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot \log p_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right)$


$=-\int_{X^{(0)}} d \mathbf{y}^{(0)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right)\cdot \log \left[\int d \mathbf{y}^{(1 \dots T)}q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \cdot \frac{p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{y}^{(0)}\right)} \cdot \frac{T_{\pi}\left(\mathbf{y}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{y}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)\right]
$


$=-\int_{X^{(0)}} d \mathbf{y}^{(0)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot \log \left[\int d \mathbf{y}^{(1 \dots T)} \  \frac{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{y}^{(0)}\right)} \cdot p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \cdot \frac{T_{\pi}\left(\mathbf{y}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{y}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)\right]
$


$\geq -\int_{X^{(0)}} d \mathbf{y}^{(0)} q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot \left( \int_{X^{(1 \dots T)}} d \mathbf{y}^{(1 \dots T)} \cdot  \frac{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{y}^{(0)}\right)} \cdot  \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \cdot \frac{T_{\pi}\left(\mathbf{y}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{y}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)\right]\right)$(âˆµ [Jensenã®ä¸ç­‰å¼](https://ja.wikipedia.org/wiki/%E3%82%A4%E3%82%A7%E3%83%B3%E3%82%BB%E3%83%B3%E3%81%AE%E4%B8%8D%E7%AD%89%E5%BC%8F), $\int_{X^{(1...T)}} \frac{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{y}^{(0)}\right)} = 1$ (âˆµ å‘¨è¾ºåˆ†å¸ƒã®å®šç¾©) )


$= -\int_{X^{(0)}} d \mathbf{y}^{(0)}  \left( \int_{X^{(1 \dots T)}} d \mathbf{y}^{(1 \dots T)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot  \frac{q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right)}{q^{(0)}_{X_{abs}}\left(\mathbf{y}^{(0)}\right)} \cdot  \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \cdot \frac{T_{\pi}\left(\mathbf{y}^{(0)} \mid \mathbf{y}^{(1)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(1)} \mid  \mathbf{y}^{(0)};\beta_{t}\right)} \cdot \left(  \prod_{t=2}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)\right]\right)$(âˆµ $q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right)$ã¯$\int_{X^{(1...T)}}$ã«ãŠã„ã¦å®šæ•°)


$= - \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \  q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0 \dots T)}\right) \cdot  \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \cdot \left(  \prod_{t=1}^T \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right)\right]$


 (âˆµ ç´„åˆ† & é‡ç©åˆ†ã¯ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ & ç´°ã‹ã„ç•¥è¨˜)ã€€(Appendix B. (38) ã¨ä¸€è‡´)


$=- \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \  q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \cdot \left( \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \right] + \sum_{t=1}^T \left(\log \left[  \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right]\right) \right)
$ (âˆµ logã‚’å’Œã«åˆ†è§£)


$=- \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \cdot \sum_{t=1}^T \left(\log \left[  \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right] \right) - \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \right]$(âˆµ ç©åˆ†ã‚’å’Œã§åˆ†è§£)


$$
= - \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot q^{(0\dots T)}_{X_{abs}}\left(\mathbf{y}^{(0)},\mathbf{y}^{(1 \dots T)}\right) \cdot \sum_{t=1}^T \left(\log \left[  \frac{ T_{\pi}\left(\mathbf{y}^{(t-1)} \mid \mathbf{y}^{(t)};\beta_{t}\right)}{T_{\pi}\left(\mathbf{y}^{(t)} \mid \mathbf{y}^{(t-1)};\beta_{t}\right)} \right] \right) - \int_{X^{(0 \dots T)}} d\mathbf{y}^{(0 \dots T)} \ q_{X_{abs}}^{(0)}\left(\mathbf{y}^{(0)}\right) \cdot \log \left[p^{(T)}_{X_{abs}}\left(\mathbf{y}^{(T)}\right) \right]$$


## 2.5. Multiplying Distributions, and Computing Posteriors


## 2.6. Entropy of Reverse Process


# 3. Experiments


## 3.1. Toy Problem


## 3.2. Images


# 4. Conclusion


# ãƒ¡ãƒ¢

- å°æ—ã•ã‚“MTGã‚ã‚‚

## å°æ—ã•ã‚“MTGãƒ¡ãƒ¢

# ã–ã£ãã‚Šã—ãŸç‰©ç†çš„ã‚¤ãƒ¡ãƒ¼ã‚¸

- ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã£ã¦ï¼Ÿ
        - ä½•ã‹ â†’ ä¼¼ãŸã‚„ã¤ã‚’ä½œã‚‹
        - â†’ = ç¢ºç‡åˆ†å¸ƒ
- ç¢ºç‡åˆ†å¸ƒ =  åˆ†é…é–¢æ•°
        - åˆ†é…é–¢æ•°ãŒã‚ã‹ã‚Œã°ç¢ºç‡åˆ†å¸ƒãŒã‚ã‹ã‚‹
        - ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå®šç¾©ã§ãã‚‹çŠ¶æ³ãªã‚‰ãªã‚“ã§ã‚‚åˆ†é…é–¢æ•°ãŒä½¿ãˆã‚‹
- æƒ…å ±ã§ã¯ï¼Ÿ
        - å°¤åº¦ = ã‚¨ãƒãƒ«ã‚®ãƒ¼
        - å­¦ç¿’ã—ãŸãƒ‡ãƒ¼ã‚¿ã®å°¤åº¦ã‚’é«˜ã‚ã‚‹ = ãã®ç‚¹ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’æœ€å°åŒ–ã™ã‚‹
- ã‚¨ãƒãƒ«ã‚®ãƒ¼(å°¤åº¦)ã‚’æœ€é©ã•ã›ã‚‹ã®ã«é©åˆ‡ãªé–¢æ•°ã¯ä½•ï¼Ÿ
        - æ©Ÿæ¢°å­¦ç¿’ã§è¨€ãˆã°æå¤±é–¢æ•°
        - 
- é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ç¨®é¡
        - é‡å­ã‚¢ãƒ‹ãƒ¼ãƒªãƒ³ã‚°
        - é‡å­ã‚²ãƒ¼ãƒˆ